## Developer highlights {auto-animate=true}

### Spinup-benchmark 

:::: {.columns style="gap: 5%;"}

::: {.column style="width:55%;"}

::: {style="font-size: 0.65em;"}
- How do we want to evaluate hybrid ocean emulators?
  - Evaluate at `end` time only. 
  - Evaluate during `roll-out`.
  - Feed emulated state back into ocean model to check stability and evaluate over time history.
<!-- - Other features:
  - Use as part of AI emulation optimisation procedure (e.g. `loss` function).  -->
- Benchmark consists of two software components:
:::

:::

::: {.column style="width:40%; font-size: 65%; padding-left: 30px;"}
[{{< fa brands github >}}/m2lines/spinup-evaluation](https://github.com/m2lines/nemo-spinup-evaluation)

{{< qrcode https://github.com/m2lines/spinup-evaluation width=100 height=100 >}}

version `0.2`
:::

::::

:::{.notes}
- mention the correction of the model 
- We have produced a piece of software that evaluates spin-up 
:::


## Developer highlights {auto-animate=true .smaller}

### Spinup-evaluation (1)
- {{< fa chart-line >}} Computes metrics on raw emulator outputs (`.npy`), instantaneous (`restart.nc`) and time averaged (`grid.nc`) output files & **statistical comparisons**
- {{< fa diagram-project >}} Strict mapping of ocean variables to `restart`, `grid` (output) and `mesh_data` names
- Provides a framework to easily add **new metrics** 
- Implements temporal downsampling -- all possible metrics computed even if data output at different cadences. 

:::: {.columns style="gap: 5%;"}
::: {.column style="width:65%;"}
<div style="display: grid; grid-template-columns: 120px 40px 180px 40px 140px; align-items: center; justify-content: center; margin-top: 25px; font-size: 0.6em; row-gap: 5px;">
  <div data-id="ref-box" style="background-color: #9b59b6; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 3; grid-row: 1;">reference files</div>
  <div data-id="ref-arrow" style="color: #fff; font-size: 2em; text-align: center; grid-column: 3; grid-row: 2; margin-bottom: -20px;">↓</div>
  <div data-id="restart-box" style="background-color: #2ecc71; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 1; grid-row: 2;">restart.nc</div>
  <div data-id="restart-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 2; grid-row: 2;transform: rotate(45deg);">→</div>
  <div data-id="eval-box" style="background-color: #3498db; padding: 12px 20px; border-radius: 5px; text-align: center; font-weight: bold; grid-column: 3; grid-row: 3 / 6 ; align-self: center; margin-top: -35px;">Spinup<br/>Evaluation</div>
  <div data-id="eval-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 4; grid-row: 3 / 6 ; align-self: center;margin-top: -35px;">→</div>
  <div data-id="metrics-box" style="background-color: #b7beba; padding: 12px 15px; border-radius: 5px; text-align: center; grid-column: 5; grid-row: 3 / 6; align-self: center; margin-top: -35px;">metrics.csv</div>
  <div data-id="output-box" style="background-color: #2ecc71; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 1; grid-row: 3;">output.nc</div>
  <div data-id="output-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 2; grid-row: 3;">→</div>
  <div data-id="mesh-box" style="background-color: #2ecc71; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 1; grid-row: 4;">mmask.nc</div>
  <div data-id="mesh-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 2; grid-row: 4;">→</div>
  <div data-id="raw-box" style="background-color: #f1c40f; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 1; grid-row: 5;">raw.npy</div>
  <div data-id="raw-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 2; grid-row: 5; transform: rotate(-45deg);">→</div>
</div>
:::
::: {.column style="width:25%; font-size: 0.5em; padding-left: 20px;"}
[{{< fa brands github >}}/m2lines/spinup-evaluation](https://github.com/m2lines/nemo-spinup-evaluation)

{{< qrcode https://github.com/m2lines/spinup-evaluation width=100 height=100 >}}

version `0.2`
:::
::::

::: {.notes}
- Very much in development
- We want the software to be easily adaptable for new science cases actively working on this.
- Temporal downsampling - ensure that all metrics can be computed regardless of the temporal frequency of the data. I.e. if we have a metric that's a function of salinity, SSH and temperature, but only ssh is output every month, we'll still compute that metric.
:::

## Developer highlights {auto-animate=true}
### Spinup-restart/translator (2) {.smaller}

::: {style="font-size: 0.65em;"}
- Take an **emulator** state and converts to NEMO compatible `restart.nc` file
- Basic validation gate; does **grid encoding** and **sanity checks** (existence of `NaNs` etc)
- *Regrid*, *upscale*, *downscale* resolution;
- Encode other **physical assumptions** (geostrophic velocities)
<!-- - $$NEMO \rightleftharpoons Oceananigans \rightleftharpoons OM4$$  (in progress...) -->
:::

:::{.fragment .fade-out fragment-index=1}
<div style="display: grid; grid-template-columns: 120px 40px 180px 40px 180px 40px 140px; align-items: center; justify-content: center; margin-top: 10px; font-size: 0.6em; row-gap: 2px;">
  <div data-id="ref-box" style="background-color: #9b59b6; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 3; grid-row: 2;">reference files</div>
  <div data-id="ref-arrow" style="color: #fff; font-size: 2em; text-align: center; grid-column: 3; grid-row: 3; line-height: 0.5;">↓</div>
  <div data-id="restart-box" style="background-color: #2ecc71; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 1; grid-row: 3;">restart.nc</div>
  <div data-id="restart-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 2; grid-row: 3; transform: rotate(45deg);">→</div>
  <div data-id="restart-proc-box" style="background-color: #e74c3c; padding: 12px 20px; border-radius: 5px; text-align: center; font-weight: bold; grid-column: 3; grid-row: 3 / 7; align-self: center;">Spinup<br/>Translator</div>
  <div data-id="restart-proc-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 4; grid-row: 3 / 7; align-self: center;">→</div>
  <div data-id="eval-box" style="background-color: #3498db; padding: 12px 20px; border-radius: 5px; text-align: center; font-weight: bold; grid-column: 5; grid-row: 3 / 7; align-self: center;">Spinup<br/>Evaluation</div>
  <div data-id="eval-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 6; grid-row: 3 / 7; align-self: center;">→</div>
  <div data-id="metrics-box" style="background-color: #b7beba; padding: 12px 15px; border-radius: 5px; text-align: center; grid-column: 7; grid-row: 3 / 7; align-self: center;">metrics.csv</div>
  <div data-id="output-box" style="background-color: #2ecc71; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 1; grid-row: 4;">output.nc</div>
  <div data-id="output-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 2; grid-row: 4;">→</div>
  <div data-id="mesh-box" style="background-color: #2ecc71; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 1; grid-row: 5;">mmask.nc</div>
  <div data-id="mesh-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 2; grid-row: 5;">→</div>
  <div data-id="raw-box" style="background-color: #f1c40f; padding: 8px 12px; border-radius: 5px; text-align: center; grid-column: 1; grid-row: 6;">raw.npy</div>
  <div data-id="raw-arrow" style="color: #ffff; font-size: 2em; text-align: center; grid-column: 2; grid-row: 6; transform: rotate(-45deg);">→</div>
</div>
:::

  <!-- - to establish structural uncertainty between different ocean models.  -->


:::{.fragment .fade-in fragment-index=1 .absolute top="50%" left="10%"}
<div style="display: flex; flex-direction: row; align-items: center; justify-content: center; gap: 15px; margin-top: 50px;">
  
  <img src="./images/logos/NEMO_logo.png" style="height: 60px; filter: brightness(0) invert(1);" alt="NEMO">
  
  <span style="color: #2ecc71; font-size: 1.5em;">{{< fa arrow-right-arrow-left >}}</span>
  
  <img src="./images/logos/oceananigans.png" style="height: 60px;" alt="Oceananigans">
  
  <span style="color: #2ecc71; font-size: 1.5em;">{{< fa arrow-right-arrow-left >}}</span>
  
  <img src="./images/logos/MOM6.png" style="height: 60px;" alt="MOM6">

</div>
:::

::: {.fragment fragment-index=1 style="font-size: 0.65em; position: absolute; bottom: 150px;"}
 Translate between other ocean model restart files - potentially difficult due to grids (in progress..)
:::

::: {.notes}
  - this is the module or 'glue' to enable physical timestepping 
  - to establish structural uncertainty between different ocean models. 
  - Often the case that we do our machine learning at a lower resolution because the compute demands are so high - and then upscale
:::




## Software engineering {.smaller}

::: {.columns}

::: {.column width="55%"}

::: {.fragment}
#### **Modular & Generalizable**
- Reusable components across domains
- Extensible to new models (e.g., MOM6, *Oceananigans*)
:::

::: {.fragment}
#### **Quality & Standards**
- Robust testing (Unit, Integration, Coverage) with CI 
- Well documented end-to-end examples (hybrid)
- Data products adhere to **FAIR** [see @fair2016]
- **Collaborative Design**: Bridging Science & RSE

::: {.absolute style="top: 37%; left: 45%; background-color: None; padding: 10px; border-radius: 8px; display: flex; align-items: center; justify-content: center; width :100px; height: 80px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"}
![](./images/logos/netcdf.avif){height="80px"}
:::

::: {.absolute style="top: 37%; left: 55%; background-color: None; padding: 10px; border-radius: 8px; display: flex; align-items: center; justify-content: center; width :100px; height: 80px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"}
![](./images/logos/xarray.webp){height="80px"}

:::


::: {.absolute style="top: 50%; left: 50%; background-color: None; padding: 10px; border-radius: 8px; display: flex; align-items: center; justify-content: center; width :100px; height: 80px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);"}
![](./images/logos/pytest.svg){height="140px"}
:::
:::
:::

::: {.column width="45%"}
<!-- ![](./images/rse-collaboration-diagram.png){fig-align="center"} -->

:::  {.fragment}
```{mermaid}
%%| fig-width: 4
graph TD
    A(Scientific Expertise) --- C{RSE Bridge}
    B(Software Engineering) --- C
    C --> D[Sustainable Tools]
    
    classDef default fill:#1a365d,stroke:#fff,stroke-width:2px,color:#fff,font-size:18px;
    classDef highlight fill:#84BD00,stroke:#fff,stroke-width:2px,color:#fff,font-size:18px;
    classDef bridge fill:#003E51,stroke:#fff,stroke-width:2px,color:#fff,font-size:18px;

    class A,B default;
    class C bridge;
    class D highlight;
    
    linkStyle default stroke:#fff,stroke-width:2px;
```

> Eliminating silos through cross-disciplinary partnership.
:::
:::

:::

::: {.notes}
- I've mentioned spinup but the long term plan to to extend this to other domains.
- hopefully bug free. Working with netcdf files and xarray it's surprising how easy it is for errors to creep in.
- We often see 'Scientific Expertise' on one side and 'Software Engineering' on the other, but without a formal bridge, the results are often fragile scripts that break when a postdoc leaves. By embedding RSEs into the design process, we aren't just writing code; we are building Sustainable Tools
:::